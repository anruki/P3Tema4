function [lambda, x] = PotenciaInvLU(A, tol)
%  función que calcula el menor autovalor y su autovector asociado 
% mediante el método de la potencia inversa sin calcular la inversa de la matriz. 
% INPUTS: 
%   A = matriz sobre la que se calcula
%   tol = error máximo permitido calculado como el error relativo, que es igual a la
%   norma infinito de una
%   iteración menos la anterior.
% OUTPUTS:
%   lambda = el menor autovalor en valor absoluto 
%   x = su autovector correspondiente.

    % Descomposición LU de A
    [L, U] = lu(A);
    
    % Vector inicial
    x = ones(size(A, 1), 1);
    
    % Tolerancia
    err = 1;
    
    % Iteraciones
    while err > tol
        % Guardar la iteración anterior
        x0 = x;
        
        % Resolver el sistema triangular inferior
        y = L \ x0;
        
        % Resolver el sistema triangular superior
        x = U \ y;
        
        % Calcular el autovalor
        lambda = x' * x / (x0' * x);
        
        % Calcular el error relativo 
        err = norm(x - x0, inf);
    end
    
    % Invertir el autovalor para obtener el menor autovalor de A
    lambda = 1 / lambda;
end
